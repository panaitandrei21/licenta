--mod(a, 2) = modulo
--ceil(n) rotunjire in sus 
--floor(n) rotunjire in jos
--trunk(n, m) - trunk(1234, -2) = 1200 rotunjire in jos da ii zici la ce nivel
-- trunk(1234, -1) = 1230
--round(1234.1234, 2) = 1234,12


--pentru toti angajatii care au id-ul impar selectati nume, denumire departament,
--salariu, salariu/3, valoarea rotunjita la sute a salariului impartit la 3,
--valoarea trunchiata la sutimi a salariului impartit la 3 si valoarea intreaga
-- a salariului impartit la 3

--select ename, dname, sal, sal / 3 salaux, trunc(sal / 3, -100), floor(sal / 3)
--from emp e, dept d
--where
--	e.deptno = d.deptno
--	and
--	mod(e.empno, 2) != 0;
--creati o lista in care sa fie calculata o prima pentru angajatii care nu primesc comision
--nu au functia de manager si s-au angajat inainte de 'ALLEN'
--prima este 23% din venitul lunar al angajatului in valoare rotunjita la intregi
--veti anfisa angajatul, functia, comisionul, data angajarii, data ang lui ALLEN si prima
--select a.ename, a.job, a.comm, a.hiredate, al.hiredate, round((a.sal + nvl(a.comm, 0)) * 0.23))
--from emp a, emp al
--where 
--	al.ename = 'ALLEN'
--	and
--	a.hiredate < al.hiredate
--	and
--	a.job != 'MANAGER'
--	and
--	nvl(a.comm, 0) = 0;

--concat(a, b) concatenare a 2 stringuri , pt mai multe concat(a, concat(b,c))
--like '-----'
--length(a)
--substr(sirmare, a, b) - substr(sirmare, -3) (ultimele 3 caractere)
--lpad() rpad() padding pana la o anumita dimensiune
--ltrim() rtrim() sterg caractere 
--replace('FACULTATE', 'TA', 'xy') inlocuieste ta cu xy
--translate('FACULTATE', 'TA', 'xy') inlocuieste oriunde gaseste t cu x si oriunde gaseste a inlocuieste cu y
-- resulta fyculxyxe
-- replace('facultate', 'ta', '') sterge ta => faculte
--translate('facultate', 'ta' 'x') => fculxxe


--selectati toti angajatii din departamentele cu denumirea diferita de o valoare citita
-- de la tastatura, angajati care contin in numele lor litera 'C' si care nu primesc
--comision, la afisare numele angajatului se va concatena cu denumirea departamentului
--sau intr-un sir in forma angajatul ename este in departamentul dname afisat alaturi de
--coloanele sal si comision in valori rotunjite la zeci

  SELECT e.ENAME || ' este in departementul  ' || d.DNAME AS EMP_DEPT, 
         ROUND(e.SAL, 1) AS SAL, ROUND(e.COMM, 0) AS COMM
  FROM emp e
  JOIN dept d ON e.DEPTNO = d.DEPTNO
  WHERE d.DNAME != '&v_dept_name'
    AND e.ENAME LIKE '%C%'
    AND e.COMM IS NULL;

--pentru fiecare angajat sa se calculeze de cate ori apare in jobul angajatului grupul
--ultimelor 2 litere din nume in ordinea respectiva 
select ename, substr(ename, -2) ultimele, replace(job, substr(ename, -2), '') jobredus,
	length(job) - length(replace(job, substr(ename, -2), '')) / 2 nr_ad
from emp
where
	length(job) - length(replace(job, substr(ename, -2), '')) > 0;



--functii pe date 
--data curenta in oracle este SYSDATE
select SYSDATE from sys.dual;

-- data + nr = data peste nr de zile
-- d1 - d2 = nr de zile dintre date
--addmonths(d1, n) la data d1 adauga n luni
--months_between(d1, d2)
--last_day(d1) ultima zi din luna
--next_day(d1, 'TUESDAY') ->urmatoarea zi de marti
--extract(day from sysdate) month from hiredate

--pt toti angajatii care nu il au ca sef pe 'BLAKE' selectati numele ang, numele sefului nr de luni trecute
--intre nag sefului si a ang, vechimea munca a ang, numarul zilei curente de azi obtinuta cu extract si
--apoi obtinuta cu to_char
SELECT e.ENAME, m.ENAME AS MANAGER_NAME, 
       MONTHS_BETWEEN(SYSDATE, e.HIREDATE) AS MONTHS_WORKED,
       TRUNC(MONTHS_BETWEEN(SYSDATE, m.HIREDATE)) AS MONTHS_WITH_MANAGER,
       EXTRACT(DAY FROM SYSDATE) AS CURRENT_DAY_EXTRACT,
       TO_NUMBER(TO_CHAR(SYSDATE, 'DD')) AS CURRENT_DAY_TO_CHAR
FROM emp e
LEFT JOIN emp m ON e.MGR = m.EMPNO
WHERE m.ENAME != 'BLAKE';


select distinct e.ename as employee_name, m.ename as manager_name
from emp e
left join emp m ON e.MGR = m.empno;


--pentru fiecare angajat care nu primeste comision sa se afiseze numele lui 
--venitul lui si o apreciere a venitului
--daca venitul este < 1500 slabut
--daca >= ok
--union
--intersect
--minus

select ename, sal + nvl(com, 0) venit, 'slabut'
from emp
where
nvl(comm, 0) =0